package com.garage.storage;

import java.io.File;
import java.util.ArrayList;
import java.util.List;

import org.springframework.stereotype.Component;

import com.fasterxml.jackson.databind.ObjectMapper;

@Component
public class FileStorage {

	
	 private final File file = new File("D:\\garage\\vehicles.json");
	    private final ObjectMapper mapper = new ObjectMapper();

	    public synchronized List<Object> load() {
	        try {
	            if (!file.exists()) return new ArrayList<>();
	            return mapper.readValue(file, List.class);
	        } catch (Exception e) {
	            return new ArrayList<>();
	        }
	    }

	    public synchronized void save(List<?> vehicles) {
	        try {
	            file.getParentFile().mkdirs();
	            mapper.writerWithDefaultPrettyPrinter().writeValue(file, vehicles);
	        } catch (Exception ignored) {}
	    }
}
